# Some Assembly Required 1
### Author: Sears Schulz
### Web Exploitation: 70 points

http://mercury.picoctf.net:40226/index.html

---

Visiting the site, we see a input field to enter the flag. If we submit the flag, it returns correct, otherwise it returns incorrect. I would recommend using Google Chrome for this entire series of challenges.

If you Inspect Element, and go to the Sources tab, you see that under `wasm` there is a file. WASM is WebAssembly, a binary format for a virtual stack machine. Basically, the idea is that you can compile programs into WASM for usage in web applications.

Under this WASM file, we see a function Chrome helpfully labeled as `check_flag`. Reading over the function, we see a call to `strcmp`, which presumably checks our string. However, before it the instructions are:

```
    i32.const 0
    local.set $var0
    i32.const 1072
    local.set $var1
    i32.const 1024
    local.set $var2
    local.get $var2
    local.get $var1
```

The last two variables retrieved are `var1` and `var2`, with constant values of `1072` and `1024`. This means that the arguments passed to `strcmp` are `1024` and `1072`, which clearly is not our input string. This means that these numbers likely refer to offsets in memory. Our string is probably stored at one of these offsets as a character array and checked against another string at the other offset.

We can view the WASM binary's memory in Chrome. Set a breakpoint in the `check_flag` function by clicking a line number. Press the submit button and the code will pause at the selected line. On the right you will be able to see the stack machine. Click `Module -> $memory -> buffer -> [[Int8Array]] -> [0 ... 9999] -> [1000 ... 1099]` and scroll down to `1024`. You can see ascii that is our flag.

![](/Images/wasm1.PNG)

flag: `picoCTF{cb688c00b5a2ede7eaedcae883735759}`

# Some Assembly Required 2
### Author: Sears Schulz
### Web Exploitation: 110 points

http://mercury.picoctf.net:44570/index.html

---

Read [Some Assembly Required 1](../Some%20Assembly%20Required%201).

Under this WASM file, we scroll to the bottom and we see the following data: `xakgK\5cNs><m:i1>1991:nkjl<ii1j0n=mm09;<i:u`

Right above the data, we see the function `copy_char`. Looking at this function, we see interesting code. Specifically:

```
      i32.const 8
      local.set $var7
      local.get $var6
      local.get $var7
      i32.xor
```

This means that our data is liekly XORed with `\x08` before being stored into memory. Taking the data string and XORing with `\x08` gives us the flag. Note that `\5c` is one byte (`\x5c`), which is equivalent to `\`. 

![](/Images/wasm2.PNG)

Alternatively, you can go look at the memory after it is XORed. Place a breakpoint at any point in `check_flag` by clicking a line number in the function. Press submit and the code will stop at your breakpoint. Go to `Module -> $memory -> buffer -> [[Int8Array]] -> [0 ... 9999] -> [1000 ... 1099]` and scroll down to index `1024`. The integers there are ascii codes for our flag.

flag: `picoCTF{64e2a9691192fcbd4aa9b8f5ee8134a2}`

# Some Assembly Required 3
### Author: Sears Schulz
### Web Exploitation: 200 points

http://mercury.picoctf.net:23511/index.html

---

Read [Some Assembly Required 3](../Some%20Assembly%20Required%203).

Looking at our WASM again, we see that `copy_char` no longer manipulates the data string. Instead, it's all done in `check_flag`.

Set a breakpoint at each `XOR` in the `check_flag` function. Input 41 characters, since that's the length of the data string and every flag thus far in the series. Write down the operations that occur at each breakpoint, each input character in its own column. You should see a pattern, which I've put down below (only first 4 letters):

|Operation |112 (p)|105 (i)|99 (c)|111 (o)|
|-|-|-|-|-|
| ^ 20| 112 ^ 20 = 100| 105 ^ 20 = 125| 99 ^ 20 = 119| 111 ^ 20 = 123|
| ^ with previous result| N/A | 125 ^ 106 = 23| 119 ^ 24 = 111 | 123 ^ 97 = 26| 
| ^ with result 3 characters ago| N/A | N/A | N/A | 26 ^ 106|
| ^ with index % 10 | 100 ^ 0 = 100 | 23 ^ 1 = 22 | 111 ^ 2 = 109 | 112 ^ 3  = 115|
| ^ 9 if index even<br/>^ 8 index odd| 100 ^ 9 = 109| 22 ^ 8 = 30| 109 ^ 9 = 100| 115 ^ 8 = 123|
| ^ 7 if index%3 = 0<br/>^ 6 if index%3 = 1<br/>^ 5 if index   = 2| 109 ^ 7 = 106| 30 ^ 6 = 24| 100 ^ 5 = 97| 123 ^ 7 = 124|
|Result| 106| 24 | 97 | 124|

Now put a breakpoint at the call to `strcmp` and at that point access the memory. At index 1025 we see the string our input is checked against. Pull the string from the data. You should get the following array:

`flag = [24, 106, 124, 97, 17, 56, 105, 55, 79, 9, 126, 14, 56, 76, 4, 110, 92, 20, 27, 122, 62, 60, 29, 8, 113, 4, 52, 74, 92, 103, 10, 65, 23, 124, 99, 96, 23, 93, 43, 84, 90]`

As you can see the order of each pair of characters is also swapped.

Now all we have to do is unswap then reverse the XOR operations we found to get our flag.

[Here](wasm4.py) is my solve script.

flag: `picoCTF{ac3aec48580fcb439b8f1a3702bc5700}`
